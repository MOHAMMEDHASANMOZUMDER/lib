<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Settings - CUET Library Admin</title>

    <link rel="stylesheet" href="styles/main.css"/>
    <link rel="stylesheet" href="css/admin-modals.css" />
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <style>
        :root { --bg:#f4f6f9; --panel:#fff; --muted:#64748b; --accent:#0ea5a3; --danger:#ef4444; --sidebar:#2d6a38; --sidebar-text:#e6edf3; }
        html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#111}
        .admin-layout{display:flex;min-height:100vh}
        .sidebar{width:260px;background:var(--sidebar);color:var(--sidebar-text);padding:28px 20px;box-shadow:2px 0 8px rgba(2,6,23,0.12);display:flex;flex-direction:column;gap:20px}
        .sidebar .brand{display:flex;align-items:center;gap:12px;font-weight:700;font-size:16px}
        .sidebar .nav{display:flex;flex-direction:column;gap:8px;margin-top:8px}
        .sidebar .nav a{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;color:#cfe7ff;text-decoration:none;font-size:14px}
        .sidebar .nav a.active,.sidebar .nav a:hover{background:rgba(255,255,255,0.04);color:#fff}
        .sidebar .small{font-size:12px;color:#97a6b7;margin-top:auto}
        .main{flex:1;padding:28px}
        .main-header{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:18px}
        h1{margin:0;font-size:20px}
        .search{flex:1;display:flex;gap:12px;align-items:center;background:#fff;padding:10px 12px;border-radius:10px;box-shadow:0 1px 2px rgba(16,24,40,.04)}
        .search input{border:0;outline:0;width:100%;font-size:14px;background:transparent}
        .settings-grid{display:grid;grid-template-columns: 1fr 360px;gap:18px}
        @media (max-width:980px){ .settings-grid{grid-template-columns:1fr} .sidebar{display:none} }
        .panel{background:var(--panel);padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(12,24,48,0.06)}
        .section-title{display:flex;align-items:center;gap:10px;font-weight:700;color:#0f1724;margin-bottom:12px}
        .form-row{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
        .form-row.inline{flex-direction:row;align-items:center;gap:12px}
        label{font-size:13px;color:#0f1724;font-weight:600}
        .help{font-size:12px;color:var(--muted)}
        input[type="text"], input[type="email"], select, textarea{padding:10px;border-radius:8px;border:1px solid #eef2f6;font-size:14px;background:#fff;outline:none;width:100%}
        textarea{min-height:100px;resize:vertical}
        .toggle{display:inline-flex;align-items:center;gap:8px;cursor:pointer}
        .switch{width:44px;height:24px;background:#e6eef2;border-radius:999px;position:relative;transition:all .18s}
        .switch .knob{position:absolute;top:3px;left:3px;width:18px;height:18px;background:#fff;border-radius:50%;box-shadow:0 2px 6px rgba(2,6,23,.08);transition:left .18s}
        .switch.on{background:var(--accent)}
        .switch.on .knob{left:23px}
        .row{display:flex;gap:12px;align-items:center}
        .muted{color:var(--muted);font-size:13px}
        .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;font-size:13px;border:0;cursor:pointer}
        .btn-primary{background:var(--accent);color:#fff}
        .btn-ghost{background:transparent;color:#0f1724;border:1px solid #e6eef2}
        .btn-danger{background:var(--danger);color:#fff}
        .card{background:var(--panel);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(12,24,48,0.06)}
        .small-list{display:flex;flex-direction:column;gap:8px}
        .integration{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;border:1px solid #f1f5f9}
    </style>
</head>
<body>
<div class="admin-layout">
    <aside class="sidebar" aria-label="Admin navigation">
            <div class="brand">
                <img src="images/cuet-logo.png" alt="CUET" style="width:36px;height:36px;border-radius:6px"/>
                <div>
                    <div style="font-size:15px">CUET Library Admin</div>
                    <div style="font-size:12px;color:#9fb6cc">Management Console</div>
                </div>
            </div>

            <nav class="nav" role="navigation">
                <a href="admin.html"><i data-lucide="grid"></i> Dashboard</a>
                <a href="admin-books.html"><i data-lucide="book"></i> Manage Books</a>
                <a href="admin-prebook.html"><i data-lucide="calendar"></i> Prebookings</a>
                <a href="admin-fines.html"><i data-lucide="dollar-sign"></i> Fines</a>
                <a href="admin-notes.html"><i data-lucide="file-text"></i> Notes Moderation</a>
                <a href="admin-settings.html"><i data-lucide="settings"></i> Settings</a>
            </nav>

            <div class="small">Signed in as <strong>Admin</strong></div>
        </aside>

    <main class="main">
        <div class="main-header">
            <div style="display:flex; gap:16px; align-items:center;">
                <h1>System Settings</h1>
                <div class="muted">Configure application behavior, appearance and integrations</div>
            </div>

            <div style="display:flex; gap:12px; align-items:center;">
                <div class="search" style="max-width:420px;">
                    <i data-lucide="search"></i>
                    <input placeholder="Search settings..." id="settingsSearch" oninput="searchSettings()"/>
                </div>
                <button class="btn btn-ghost" onclick="logout()" style="padding:8px 10px;border-radius:8px;">Log out</button>
            </div>
        </div>

        <div class="settings-grid" id="settingsGrid">
            <div>
                <div class="panel" id="generalSettings">
                    <div class="section-title"><i data-lucide="slack"></i> General</div>
                    <div class="form-row">
                        <label for="siteName">Site Name</label>
                        <input id="siteName" type="text" value="CUET Library Management System"/>
                        <div class="help">Displayed in the header and emails.</div>
                    </div>
                    <div class="form-row">
                        <label for="supportEmail">Support Email</label>
                        <input id="supportEmail" type="email" value="support@cuet.edu.bd"/>
                        <div class="help">Used as sender for system notifications.</div>
                    </div>
                    <div class="form-row inline" style="align-items:center;">
                        <label style="min-width:160px;">Default borrowing period</label>
                        <select id="defaultLoanDays" style="max-width:160px;">
                            <option value="7">7 days</option>
                            <option value="14" selected>14 days</option>
                            <option value="28">28 days</option>
                        </select>
                        <div class="help" style="margin-left:8px;">Standard loan duration for students</div>
                    </div>
                    <div class="form-row inline" style="align-items:center;">
                        <label style="min-width:160px;">Allow student self-registration</label>
                        <div class="toggle" onclick="toggleSwitch('selfRegSwitch')">
                            <div id="selfRegSwitch" class="switch on"><div class="knob"></div></div>
                            <div class="muted">Enabled</div>
                        </div>
                    </div>
                    <hr style="border:none;border-top:1px solid #eef2f6;margin:12px 0"/>
                    <div class="row" style="justify-content:flex-end">
                        <button class="btn btn-ghost" onclick="resetGeneral()">Reset</button>
                        <button class="btn btn-primary" onclick="saveSettings('general')"><i data-lucide="save"></i> Save General</button>
                    </div>
                </div>

                <div class="panel" style="margin-top:18px" id="appearanceSettings">
                    <div class="section-title"><i data-lucide="monitor"></i> Appearance</div>
                    <div class="form-row">
                        <label>Theme</label>
                        <div class="row">
                            <button class="btn btn-ghost" onclick="setTheme('light')">Light</button>
                            <button class="btn btn-ghost" onclick="setTheme('dark')">Dark</button>
                            <button class="btn btn-ghost" onclick="setTheme('auto')">Auto (system)</button>
                        </div>
                        <div class="help">Choose the admin console color theme.</div>
                    </div>
                    <div class="form-row">
                        <label for="accentColor">Primary Accent</label>
                        <input id="accentColor" type="text" value="#0ea5a3"/>
                        <div class="help">Hex color used for primary buttons and highlights.</div>
                    </div>
                    <div class="row" style="justify-content:flex-end;margin-top:8px">
                        <button class="btn btn-primary" onclick="saveSettings('appearance')"><i data-lucide="wand"></i> Apply Appearance</button>
                    </div>
                </div>

                <div class="panel" style="margin-top:18px" id="notificationSettings">
                    <div class="section-title"><i data-lucide="bell"></i> Notifications</div>
                    <div class="form-row inline" style="align-items:center;">
                        <label style="min-width:200px;">Email notifications for fines</label>
                        <div class="toggle" onclick="toggleSwitch('finesEmail')">
                            <div id="finesEmail" class="switch on"><div class="knob"></div></div>
                            <div class="muted">Enabled</div>
                        </div>
                    </div>
                    <div class="form-row inline" style="align-items:center;">
                        <label style="min-width:200px;">Notes uploaded: auto-approve</label>
                        <div class="toggle" onclick="toggleSwitch('notesAuto')">
                            <div id="notesAuto" class="switch"><div class="knob"></div></div>
                            <div class="muted">Disabled</div>
                        </div>
                    </div>
                    <div class="form-row">
                        <label for="notificationEmail">Notification sender address</label>
                        <input id="notificationEmail" type="email" value="no-reply@cuet.edu.bd"/>
                    </div>
                    <div class="row" style="justify-content:flex-end;margin-top:8px">
                        <button class="btn btn-primary" onclick="saveSettings('notifications')"><i data-lucide="mail"></i> Save Notifications</button>
                    </div>
                </div>
            </div>

            <aside>
                <div class="card" style="margin-top:0">
                    <div style="font-weight:700;margin-bottom:8px">Admin users</div>
                    <div style="display:flex;flex-direction:column;gap:8px">
                        <div style="display:flex;justify-content:space-between;align-items:center">
                            <div>
                                <div style="font-weight:700">Admin</div>
                                <div class="muted" style="font-size:12px">admin@cuet.edu.bd</div>
                            </div>
                            <div>
                                <button class="btn btn-ghost" onclick="editUser('admin')">Edit</button>
                            </div>
                        </div>
                        <div style="display:flex;justify-content:space-between;align-items:center">
                            <div>
                                <div style="font-weight:700">Library Manager</div>
                                <div class="muted" style="font-size:12px">manager@cuet.edu.bd</div>
                            </div>
                            <div>
                                <button class="btn btn-ghost" onclick="editUser('manager')">Edit</button>
                            </div>
                        </div>
                        <div style="display:flex;justify-content:flex-end;margin-top:8px">
                            <button class="btn btn-primary" onclick="openAddAdmin()"><i data-lucide="user-plus"></i> Add Admin</button>
                        </div>
                    </div>
                </div>
            </aside>
        </div>

        <footer style="color:#94a3b8;font-size:13px;margin-top:14px">&copy; 2025 CUET Library Management System â€” Admin Panel</footer>
    </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    if (window.lucide) lucide.replace();
});

function logout(){ location.href = 'index.html'; }
function saveSettings(section){
    const payload = { section };
    if(section === 'general'){
        payload.siteName = document.getElementById('siteName').value;
        payload.supportEmail = document.getElementById('supportEmail').value;
        payload.defaultLoanDays = document.getElementById('defaultLoanDays').value;
        payload.selfReg = document.getElementById('selfRegSwitch').classList.contains('on');
    } else if(section === 'appearance'){
        payload.accentColor = document.getElementById('accentColor').value;
    } else if(section === 'notifications'){
        payload.finesEmail = document.getElementById('finesEmail').classList.contains('on');
        payload.notesAuto = document.getElementById('notesAuto').classList.contains('on');
        payload.notificationEmail = document.getElementById('notificationEmail').value;
    }
    console.log('Saving settings', payload);
    alert('Settings saved (' + section + '). Implement server call to persist.');
}
function toggleSwitch(id){
    const el = document.getElementById(id);
    el.classList.toggle('on');
    const parent = el.parentElement;
    const muted = parent.querySelector('.muted');
    if(muted){
        muted.textContent = el.classList.contains('on') ? 'Enabled' : 'Disabled';
    }
}
function setTheme(name){ alert('Switching theme to: ' + name + ' (implement).'); }
function resetGeneral(){
    if(!confirm('Reset general settings to defaults?')) return;
    document.getElementById('siteName').value = 'CUET Library Management System';
    document.getElementById('supportEmail').value = 'support@cuet.edu.bd';
    document.getElementById('defaultLoanDays').value = '14';
    const sw = document.getElementById('selfRegSwitch');
    if(!sw.classList.contains('on')) toggleSwitch('selfRegSwitch');
    alert('General settings reset (in-memory).');
}
function editUser(id){ alert('Edit user: ' + id); }
function openAddAdmin(){ alert('Open add admin dialog (implement).'); }
function searchSettings(){
    const q = document.getElementById('settingsSearch').value.trim().toLowerCase();
    const grid = document.getElementById('settingsGrid');
    if(!q){
        Array.from(grid.querySelectorAll('.panel')).forEach(p=>p.style.display='block');
        return;
    }
    Array.from(grid.querySelectorAll('.panel')).forEach(panel=>{
        const text = panel.innerText.toLowerCase();
        panel.style.display = text.indexOf(q) === -1 ? 'none' : 'block';
    });
}
</script>
<script src="scripts/admin.js"></script>
<script src="js/admin-modals.js"></script>
</body>
</html>
